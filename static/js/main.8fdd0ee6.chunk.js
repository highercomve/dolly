(this.webpackJsonpclone=this.webpackJsonpclone||[]).push([[0],{130:function(e,t,n){e.exports=n(171)},135:function(e,t,n){},170:function(e,t,n){},171:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"AUTH_USER_GET",(function(){return b})),n.d(r,"AUTH_USER_GET_INPROGRESS",(function(){return h})),n.d(r,"AUTH_USER_GET_SUCCESS",(function(){return S})),n.d(r,"AUTH_USER_GET_FAILURE",(function(){return g})),n.d(r,"AUTH_CLEAR_TOKEN",(function(){return j})),n.d(r,"AUTH_SAVE_TOKEN",(function(){return _}));var a={};n.r(a),n.d(a,"DEVICES_GET_ALL",(function(){return Ce})),n.d(a,"DEVICES_GET_ALL_INPROGRESS",(function(){return ye})),n.d(a,"DEVICES_GET_ALL_SUCCESS",(function(){return Te})),n.d(a,"DEVICES_GET_ALL_FAILURE",(function(){return ke})),n.d(a,"DEVICES_GET",(function(){return Re})),n.d(a,"DEVICES_GET_INPROGRESS",(function(){return Ie})),n.d(a,"DEVICES_GET_SUCCESS",(function(){return xe})),n.d(a,"DEVICES_GET_FAILURE",(function(){return Pe})),n.d(a,"DEVICES_CLONE",(function(){return Ne})),n.d(a,"DEVICES_CLONE_INPROGRESS",(function(){return we})),n.d(a,"DEVICES_CLONE_SUCCESS",(function(){return Ue})),n.d(a,"DEVICES_CLONE_FAILURE",(function(){return Le})),n.d(a,"DEVICES_SET_SOURCE",(function(){return De})),n.d(a,"DEVICES_SET_REVISION",(function(){return Ae})),n.d(a,"DEVICES_SET_CLONE_USER_META",(function(){return Ge})),n.d(a,"DEVICES_SET_DESTINATION",(function(){return Ve})),n.d(a,"DEVICES_CLEAN_FORM",(function(){return We})),n.d(a,"DEVICE_SET_FORM_ERRORS",(function(){return Fe})),n.d(a,"DEVICE_SET_PLATFORM_TO_CLONE",(function(){return He}));var c=n(0),o=n.n(c),i=n(14),u=n.n(i),s=(n(135),n(203)),l=n(76),d=n(207),f=n(206),p=n(208),v=n(37),E=n(8),m=n.n(E),O=n(13),b="AUTH_USER_GET",h="auth/user/get/inprogress",S="auth/user/get/success",g="auth/user/get/failure",j="auth/token/clear",_="auth/token/save",C=n(15),y=n(5),T=function(e,t,n){return t.payload};function k(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return{success:function(n){return{type:e["".concat(t,"_SUCCESS")],payload:n}},failure:function(n){return{type:e["".concat(t,"_FAILURE")],error:n}},inProgress:function(){return{type:e["".concat(t,"_INPROGRESS")]}}}}function R(e,t,n,r){var a,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"error",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:T,i=t["".concat(n,"_INPROGRESS")],u=t["".concat(n,"_FAILURE")],s=t["".concat(n,"_SUCCESS")];return a={},Object(C.a)(a,i,(function(t,n){return Object(y.a)(Object(y.a)({},t),{},{status:e.IN_PROGRESS})})),Object(C.a)(a,u,(function(t,n){var r;return Object(y.a)(Object(y.a)({},t),{},(r={},Object(C.a)(r,"".concat(c),n.error),Object(C.a)(r,"status",e.FAILURE),r))})),Object(C.a)(a,s,(function(t,n){var a;return r?Object(y.a)(Object(y.a)({},t),{},(a={},Object(C.a)(a,r,o(t,n,r)),Object(C.a)(a,"status",e.SUCCESS),a)):Object(y.a)(Object(y.a)(Object(y.a)({},t),o(t,n,r)),{},{status:e.SUCCESS})})),a}var I=n(99),x=n.n(I),P=Object({NODE_ENV:"production",PUBLIC_URL:"/dolly",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_PH_API_URL||"https://api.pantahub.com",N=function(){var e=Object(O.a)(m.a.mark((function e(t){var n,r,a,c,o,i,u=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]?u[1]:"",r=u.length>2&&void 0!==u[2]?u[2]:"application/json",a=u.length>3&&void 0!==u[3]?u[3]:"GET",c=u.length>4&&void 0!==u[4]?u[4]:{},o={"Content-Type":r},n&&(o.Authorization="Bearer ".concat(n)),i={method:a,headers:o},"GET"!==a&&"HEAD"!==a&&(i.body=JSON.stringify(c)),e.abrupt("return",x()(t,i));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(O.a)(m.a.mark((function e(t){var n,r,a,c,o,i=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:"GET",r=i.length>2&&void 0!==i[2]?i[2]:"",a=i.length>3&&void 0!==i[3]?i[3]:{},e.next=5,N(t,r,"application/json",n,a);case 5:return c=e.sent,e.next=8,c.json();case 8:return o=e.sent,e.abrupt("return",{ok:c.ok,redirected:c.redirected,headers:c.headers,status:c.status,json:o});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=Object(O.a)(m.a.mark((function e(t,n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",w(t,"GET",n));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),L=function(){var e=Object(O.a)(m.a.mark((function e(t,n,r){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",w(t,"POST",n,r));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();function D(e,t,n){return A.apply(this,arguments)}function A(){return(A=Object(O.a)(m.a.mark((function e(t,n,r){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t();case 3:(a=e.sent).ok?n(a.json):r("string"===typeof a.json.Error?{code:a.status,message:a.json.Error}:a.json),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),a={ok:!1,json:{code:0,message:e.t0}},r(a.json);case 11:return e.abrupt("return",a);case 12:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}var G=function(e,t){return function(n){n(function(e,t){if(401===e)return $();return{type:"error/set",payload:{type:e,error:t}}}(e.code,e.messsage)),n(t(e))}};var V=n(29),W="".concat(P,"/auth/auth_status"),F="".concat(Object({NODE_ENV:"production",PUBLIC_URL:"/dolly",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_PH_URL,"/oauth2/authorize"),H=Object({NODE_ENV:"production",PUBLIC_URL:"/dolly",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_OAUTH_CLIENT_ID,K=Object({NODE_ENV:"production",PUBLIC_URL:"/dolly",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_OAUTH_DEFAULT_SCOPE,B=function(){return"".concat(location.href)};var M=function(){localStorage.removeItem("_ph_token"),location.href=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"token",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:H;return t=t||B(),encodeURI("".concat(F,"?client_id=").concat(r,"&scope=").concat(e,"&redirect_uri=").concat(t,"&response_type=").concat(n))}()};function z(e){return Y.apply(this,arguments)}function Y(){return(Y=Object(O.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",U(W,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var J=k(r,b),$=function(){return M(),{type:j}},X=function(e){var t=function(e){return(e.match(/([^#=&]+)(=([^&]*))?/g)||[]).reduce((function(e,t){var n=t.split("="),r=Object(V.a)(n,2),a=r[0],c=r[1];return e[a]=c,e}),{})}(e);return function(e){localStorage.setItem("_ph_token",e)}(t.access_token),{type:_,payload:t.access_token}},q=n(205),Q=Object(s.a)((function(e){return{fab:{position:"absolute",top:e.spacing(2),right:e.spacing(2)}}}));var Z=Object(v.b)((function(e){return{token:e.auth.token}}),{Logout:function(){return localStorage.removeItem("_ph_token"),{type:j}}})((function(e){var t=e.token,n=e.Logout,r=Q();return null===t?null:o.a.createElement(q.a,{className:r.fab,variant:"outlined",onClick:n},"Log out")})),ee=Object(s.a)((function(e){return{icon:{marginRight:e.spacing(2)},heroContent:{backgroundColor:e.palette.background.paper,padding:e.spacing(2,0,6)},heroButtons:{marginTop:e.spacing(8)},cardGrid:{paddingTop:e.spacing(8),paddingBottom:e.spacing(8)},card:{height:"100%",display:"flex",flexDirection:"column"},cardMedia:{paddingTop:"56.25%"},cardContent:{flexGrow:1},linearProgress:{width:"100%","& > * + *":{marginTop:e.spacing(2)}},flex:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center","& > *":{margin:e.spacing(1)}},vertialSpace:{marginBottom:e.spacing(2)},footer:{backgroundColor:e.palette.background.paper,padding:e.spacing(6)}}}));function te(){return o.a.createElement(l.a,{variant:"body2",color:"textSecondary",align:"center"},"Copyright \xa9 ",o.a.createElement(f.a,{color:"inherit",href:"https://www.github.com/highercomve/dolly"},"Sergio Marin")," ",(new Date).getFullYear(),".")}function ne(e){var t=e.children,n=ee();return o.a.createElement(o.a.Fragment,null,o.a.createElement(d.a,null),o.a.createElement(Z,null),o.a.createElement("header",null,o.a.createElement(p.a,{maxWidth:"md"},o.a.createElement("img",{src:"/dolly/logo.png",alt:"Dolly",height:"100px"}))),o.a.createElement("main",null,t),o.a.createElement("footer",{className:n.footer},o.a.createElement(l.a,{variant:"subtitle1",align:"center",color:"textSecondary",component:"p"},"Pantahub cloner is a thirdparty opensource project"),o.a.createElement(te,null)))}var re,ae=n(221),ce=n(225),oe=n(219),ie=n(220),ue=n(222),se=n(107),le=n.n(se),de=n(226),fe=n(104),pe=n.n(fe),ve=(localStorage.getItem("_ph_token")||"").split("|"),Ee=Object(V.a)(ve,2),me=Ee[0],Oe=Ee[1],be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{return pe()(e)}catch(t){return{}}},he={IN_PROGRESS:"INPROGRESS",SUCCESS:"SUCCESS",FAILURE:"FAILURE"},Se=Object(y.a)({username:Oe||"",token:me||null,exp:null,id:"",nick:"",orig_iat:null,prn:"",roles:"",type:"",gettingToken:!1,getTokenError:null,status:null},be(me)),ge=Object(y.a)(Object(y.a)({},R(he,r,b,void 0,void 0,(function(e,t,n){return Object(y.a)(Object(y.a)({},e),t.payload)}))),{},(re={},Object(C.a)(re,_,(function(e,t){return Object(y.a)(Object(y.a)(Object(y.a)({},e),be(t.payload)),{},{token:t.payload})})),Object(C.a)(re,j,(function(e,t){return Object(y.a)(Object(y.a)({},Se),{},{token:null})})),re));function je(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Se,t=arguments.length>1?arguments[1]:void 0;return ge[t.type]?ge[t.type](e,t):e}var _e,Ce="DEVICES_GET_ALL",ye="devices/get/all/inprogress",Te="devices/get/all/success",ke="devices/get/all/failure",Re="DEVICES_GET",Ie="devices/get/inprogress",xe="devices/get/success",Pe="devices/get/failure",Ne="DEVICES_CLONE",we="devices/clone/inprogress",Ue="devices/clone/success",Le="devices/clone/failure",De="devices/set/source",Ae="devices/set/selected-revision",Ge="devices/set/clone-user-meta",Ve="devices/set/destination",We="devices/clear/form",Fe="devices/set/form-errors",He="devices/set/platform-to-clone";function Ke(e,t,n){return t.split(".").reduce((function(e,t){return e&&e.hasOwnProperty(t)?e[t]:n}),e)}function Be(e){return Object.keys(e).reduce((function(t,n){return t[n]=e[n].selected,t}),{})}function Me(e,t){return Object.keys(t).reduce((function(n,r){return r.indexOf("_config")>=0?n[r]=!0:e[r]?n[r]=!1:n[r]=t[r],n}),{})}function ze(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object.keys(e).reduce((function(n,r,a){if(r.indexOf("src.json")>=0||r.indexOf("_config")>=0){var c=r.replace("/src.json","");n[c]=Object(y.a)(Object(y.a)({},e[r]),{},{selected:t,name:c})}return n}),{})}function Ye(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=n?{}:Object(y.a)({},e);return Object.keys(t).forEach((function(a){!1!==t[a]||n||Object.keys(r).forEach((function(e){0===e.indexOf(a)&&delete r[e]})),!0===t[a]&&n&&Object.keys(e).forEach((function(t){0===t.indexOf(a)&&(r[t]=e[t])}))})),r}function Je(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(n)return e;var r=Be(ze(e,!0)),a=Me(r,Be(ze(t,!0))),c=Ye(t,a,!1),o=Ye(e,r,!0),i=Object(y.a)(Object(y.a)({},o),c);return i}function $e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Ke(e,"revisions",[]).find((function(t){return t.rev===e.revision}))}var Xe={IN_PROGRESS:"IN_PROGRESS",FAILURE:"FAILURE",SUCCESS:"SUCCESS",CLONING:{IN_PROGRESS:"CLONING_IN_PROGRESS",FAILURE:"CLONING_FAILURE",SUCCESS:"CLONING_SUCCESS"},WAITING_DEPLOY:"WAITING_DEPLOY"},qe={list:[],status:null,clone:null,source:null,destination:null,cloneUserMeta:!1,selectedRevision:{src:null,dest:null},platformToClone:{src:null,dest:null},formErrors:{}},Qe=function(e,t,n){return Object(y.a)(Object(y.a)({},e[n]),t.payload)},Ze=Object(y.a)(Object(y.a)(Object(y.a)({},R(Xe,a,Ce,"list",void 0,Qe)),R(Xe.CLONING,a,Ne,"clone",void 0,Qe)),{},(_e={},Object(C.a)(_e,Ve,(function(e,t){return Object(y.a)(Object(y.a)({},e),{},{destination:t.payload,selectedRevision:Object(y.a)(Object(y.a)({},e.selectedRevision),{},{dest:$e(t.payload)})})})),Object(C.a)(_e,Ge,(function(e,t){return Object(y.a)(Object(y.a)({},e),{},{cloneUserMeta:t.payload})})),Object(C.a)(_e,Fe,(function(e,t){return Object(y.a)(Object(y.a)({},e),{},{formErrors:t.payload})})),Object(C.a)(_e,Ae,(function(e,t){return Object(y.a)(Object(y.a)({},e),{},{selectedRevision:Object(y.a)(Object(y.a)({},e.selectedRevision),{},Object(C.a)({},t.pointer,t.payload))})})),Object(C.a)(_e,De,(function(e,t){return Object(y.a)(Object(y.a)({},e),{},{source:t.payload?t.payload:null,selectedRevision:Object(y.a)(Object(y.a)({},e.selectedRevision),{},{src:t.payload&&t.payload.revisions&&t.payload.revisions.length?$e(t.payload):null})})})),Object(C.a)(_e,He,(function(e,t){return Object(y.a)(Object(y.a)({},e),{},{platformToClone:Object(y.a)(Object(y.a)({},e.platformToClone),{},Object(C.a)({},t.pointer,t.payload))})})),Object(C.a)(_e,We,(function(e){return Object(y.a)(Object(y.a)({},qe),{},{list:e.list})})),_e));function et(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qe,t=arguments.length>1?arguments[1]:void 0;return Ze[t.type]?Ze[t.type](e,t):e}var tt=n(223),nt=n(209),rt=n(224),at=Object(s.a)({option:{fontSize:15,"& > span":{marginRight:10,fontSize:18}}}),ct=Object(nt.a)();function ot(e){var t=e.value,n=e.defaultClasses,r=void 0===n?{}:n,a=e.devices,c=e.label,i=e.onChange,u=void 0===i?function(){return null}:i,s=at();return o.a.createElement(rt.a,{id:"devices-select",clearOnEscape:!0,freeSolo:!0,autoHighlight:!0,style:{width:"100%"},options:a,value:t,classes:Object(y.a)(Object(y.a)({},r),{},{option:s.option}),getOptionLabel:function(e){return e["device-nick"]},filterOptions:function(e,t){var n=ct(e,t);return""!==t.inputValue&&n.push({"device-nick":"Search ".concat(t.inputValue," ..."),deviceid:t.inputValue}),n},onChange:function(e,t){u(t)},renderOption:function(e){return o.a.createElement(o.a.Fragment,null,e["device-nick"])},renderInput:function(e){return o.a.createElement(tt.a,Object.assign({},e,{label:c,variant:"outlined",fullWidth:!0,inputProps:Object(y.a)(Object(y.a)({},e.inputProps),{},{autoComplete:"Device nick"})}))}})}var it=n(228),ut=n(217),st=n(215),lt=n(216),dt=n(214);function ft(e){var t=e.buttonTxt,n=void 0===t?"":t,r=e.variant,a=void 0===r?"outlined":r,c=e.color,i=void 0===c?"primary":c,u=e.dialogText,s=void 0===u?"":u,l=e.dialogBody,d=void 0===l?null:l,f=e.cancelTxt,p=void 0===f?"Cancel":f,v=e.confirmTxt,E=void 0===v?"Confirm":v,m=e.onConfirm,O=void 0===m?function(){return null}:m,b=e.disabled,h=o.a.useState(!1),S=Object(V.a)(h,2),g=S[0],j=S[1],_=function(){j(!1)};return o.a.createElement("div",null,o.a.createElement(q.a,{variant:a,color:i,onClick:function(){j(!0)},disabled:b},n),o.a.createElement(it.a,{open:g,onClose:_,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},o.a.createElement(dt.a,{id:"alert-dialog-title"},s),o.a.createElement(st.a,null,o.a.createElement(lt.a,{id:"alert-dialog-description"},d)),o.a.createElement(ut.a,null,o.a.createElement(q.a,{onClick:_,color:"primary"},p),o.a.createElement(q.a,{onClick:function(){j(!1),O()},color:"primary",autoFocus:!0},E))))}var pt="".concat(P,"/devices"),vt="".concat(P,"/trails/summary"),Et=function(e){return"".concat(P,"/trails/").concat(e,"/steps")},mt=function(e){return"".concat(P,"/trails/").concat(e,"/summary")},Ot=function(){var e=Object(O.a)(m.a.mark((function e(t,n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",U(mt(n),t));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),bt=function(){var e=Object(O.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",U(vt,t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ht=function(){var e=Object(O.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",U(pt+"/",t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),St=function(){var e=Object(O.a)(m.a.mark((function e(t,n,r){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",L(Et(n),t,r));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),gt=function(){var e=Object(O.a)(m.a.mark((function e(t,n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",U(Et(n)+"?progress.status={%22$ne%22:%22%22}",t));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),jt=function(){var e=Object(O.a)(m.a.mark((function e(t,n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",U("".concat(pt,"/np/").concat(n),t));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),_t=k(a,Ce),Ct=k(a,Re),yt=k(a,Ne),Tt=function(e){var t={valid:!0},n=Object.values(e.list);return null===e.source&&(t.source="Please select a source device"),null===e.destination&&(t.destination="Please select a destination device"),null===e.destination||n.some((function(t){return t.deviceid===e.destination.deviceid}))||(t.destination="You need to be owner of the destination device"),Object.keys(t).length>1&&(t.valid=!1),t},kt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"src";return{type:He,payload:e,pointer:t}},Rt=function(e){return{type:De,payload:e}},It=function(e){return function(){var t=Object(O.a)(m.a.mark((function t(n,r){var a;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(Ct.inProgress()),a=r(),t.abrupt("return",D(Object(O.a)(m.a.mark((function t(){var n,r;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ot(a.auth.token,e);case 2:return n=t.sent,t.next=5,gt(a.auth.token,e);case 5:return r=t.sent,n.json.revisions=r.json,t.abrupt("return",n);case 8:case"end":return t.stop()}}),t)}))),(function(e){return n(Ct.success(e))}),(function(e){return n(G(e,Ct.failure))})));case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},xt=function(e){return function(){var t=Object(O.a)(m.a.mark((function t(n,r){var a;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(Ct.inProgress()),a=r(),t.abrupt("return",D(Object(O.a)(m.a.mark((function t(){var n,r,c;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,jt(a.auth.token,e);case 2:return n=t.sent,t.next=5,Ot(a.auth.token,n.json.id);case 5:return r=t.sent,t.next=8,gt(a.auth.token,n.json.id);case 8:return c=t.sent,r.json.revisions=c.json,t.abrupt("return",r);case 11:case"end":return t.stop()}}),t)}))),(function(e){return n(Ct.success(e))}),(function(e){return n(G(e,Ct.failure))})));case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},Pt=Object(s.a)({option:{fontSize:15,"& > span":{marginRight:10,fontSize:18}}});function Nt(e){var t=e.device,n=e.revision,r=e.label,a=e.onChange,c=void 0===a?function(){return null}:a,i=Pt();return t?o.a.createElement(rt.a,{clearOnEscape:!0,autoHighlight:!0,id:"devices-revision-select",style:{width:"100%"},options:t.revisions,classes:{option:i.option},onChange:function(e,t){c(t)},value:n,getOptionLabel:function(e){return"".concat(e.rev," (").concat(e["state-sha"],")")},renderOption:function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement("span",null,e.rev),e["commit-msg"])},renderInput:function(e){return o.a.createElement(tt.a,Object.assign({},e,{label:r,variant:"outlined",fullWidth:!0,inputProps:Object(y.a)(Object(y.a)({},e.inputProps),{},{autoComplete:"Device nick"})}))}}):null}var wt=n(218),Ut=n(106),Lt=n.n(Ut)()((function(e){return{root:{display:"flex","& > * + *":{marginLeft:e.spacing(2)}},xs:{transform:"scale(1)"},sm:{transform:"scale(2)"},lg:{transform:"scale(3)"}}}));function Dt(e){var t=e.message,n=e.size,r=Lt();return o.a.createElement("div",{className:r.root},o.a.createElement(wt.a,{className:r[n]}),t&&o.a.createElement("h4",null,t))}var At=n(213);function Gt(e){var t=e.revision,n=void 0===t?{}:t,r=e.device,a=e.onChange,i=e.label,u=Object(c.useState)({}),s=Object(V.a)(u,2),l=s[0],d=s[1];if(Object(c.useEffect)((function(){n&&n.state&&d(ze(n.state,!0))}),[n]),Object(c.useEffect)((function(){a(Object.keys(l).reduce((function(e,t){return e[t]=l[t].selected,e}),{}))}),[l,a]),!r||!n||!n.state)return null;if(l.length<=0)return o.a.createElement("div",null,"This device doesn't have any platform to clone");var f=function(e){d(Object(y.a)(Object(y.a)({},l),{},Object(C.a)({},e.target.value,Object(y.a)(Object(y.a)({},l[e.target.value]),{},{selected:e.target.checked}))))};return o.a.createElement(oe.a,{justify:"",style:{marginTop:"2em"}},i&&o.a.createElement(At.a,{style:{textAlign:"left"}},i),Object.keys(l).map((function(e){return l[e]})).map((function(e){return o.a.createElement(ie.a,{key:e.name,control:o.a.createElement(ce.a,{id:"user-meta",color:"primary",value:e.name,checked:e.selected,onChange:f,inputProps:{"aria-label":e.name}}),label:e.name})})))}var Vt=Object(v.b)((function(e){return{devices:e.devices,user:e.auth}}),{getDevices:function(){return function(){var e=Object(O.a)(m.a.mark((function e(t,n){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(_t.inProgress()),r=n(),e.abrupt("return",D(Object(O.a)(m.a.mark((function e(){var t,n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,bt(r.auth.token);case 2:return t=e.sent,e.next=5,ht(r.auth.token);case 5:return n=e.sent,e.next=8,Promise.all(t.json.map(function(){var e=Object(O.a)(m.a.mark((function e(t){var a,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,gt(r.auth.token,t.deviceid);case 3:return a=e.sent,(c=Ke(n,"json",[]).find((function(e){return e.id===t.deviceid})))&&Object.assign(t,c),t.revisions=a.json.sort((function(e,t){return e.rev<t.rev})),e.abrupt("return",t);case 10:return e.prev=10,e.t0=e.catch(0),console.info(e.t0),e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()));case 8:return a=e.sent,e.abrupt("return",Object(y.a)(Object(y.a)({},t),{},{json:a}));case 10:case"end":return e.stop()}}),e)}))),(function(e){return t(_t.success(e))}),(function(e){return t(G(e,_t.failure))})));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},setSourceAndGetPublic:function(e){return function(){var t=Object(O.a)(m.a.mark((function t(n,r){var a,c;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return",n(Rt(null)));case 2:if(a=r(),!Object.keys(a.devices.list).some((function(t){return a.devices.list[t].deviceid===e.deviceid}))){t.next=6;break}return t.abrupt("return",n(Rt(e)));case 6:return c=e.deviceid.indexOf("/")>=0?xt:It,t.abrupt("return",D(Object(O.a)(m.a.mark((function t(){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",n(c(e.deviceid)));case 1:case"end":return t.stop()}}),t)}))),(function(e){return n(Rt(e))}),(function(e){return console.info(e)})));case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},setDestination:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"src";return{type:Ve,payload:e,pointer:t}},setCloneUserMeta:function(e){return{type:Ge,payload:e}},cleanForm:function(){return{type:We}},setSelectedRevision:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"src";return{type:Ae,payload:e,pointer:t}},cloneDevice:function(){return function(){var e=Object(O.a)(m.a.mark((function e(t,n){var r,a,c,o,i,u;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t(yt.inProgress()),r=n(),(a=Tt(r.devices)).valid){e.next=7;break}return t(yt.failure({type:"invalid",error:"invalid form"})),t({type:Fe,payload:a}),e.abrupt("return");case 7:return c=Ye(r.devices.selectedRevision.src.state,r.devices.platformToClone.src),o=Ye(r.devices.selectedRevision.dest.state,r.devices.platformToClone.dest),i={state:Je(c,o),rev:-1,"commit-msg":"Cloned from device ".concat(r.devices.source["device-nick"]," rev (").concat(r.devices.selectedRevision.src.rev,")")},e.next=12,D(St.bind(null,r.auth.token,r.devices.destination.deviceid,i),(function(e){return t(yt.success(e))}),(function(e){return t(G(e,yt.failure))}));case 12:return u=e.sent,r.devices.cloneUserMeta&&console.info("TODO: Clone user-meta is not implemented yet"),e.abrupt("return",u);case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},setPlatformToClone:kt,setDestinationPlatformToClone:function(e){return kt(e,"dest")}})((function(e){var t,n=e.user,r=e.devices,a=e.getDevices,i=e.setSourceAndGetPublic,u=e.setDestination,s=e.setCloneUserMeta,d=e.cleanForm,f=e.setSelectedRevision,v=e.cloneDevice,E=e.setPlatformToClone,m=e.setDestinationPlatformToClone,O=ee(),b=Object(c.useState)(!1),h=Object(V.a)(b,2),S=h[0],g=h[1];return Object(c.useEffect)((function(){n.status===he.SUCCESS&&null===r.status&&a()}),[r,r.status,a,n,n.status]),Object(c.useEffect)((function(){r.status===Xe.CLONING.IN_PROGRESS||r.status===Xe.WAITING_DEPLOY?g(!0):g(!1)}),[r,r.status]),r.status===Xe.IN_PROGRESS?o.a.createElement("div",{className:O.heroContent},o.a.createElement(p.a,{maxWidth:"md"},o.a.createElement(l.a,{component:"h4",variant:"h4",align:"center",color:"textPrimary",gutterBottom:!0},"Welcome, ",n.nick),o.a.createElement(l.a,{variant:"h5",align:"center",color:"textSecondary",paragraph:!0},"Please wait a second, first we need to load your devices."),o.a.createElement("div",{className:O.flex,style:{height:"200px"}},o.a.createElement(Dt,{size:"lg"})))):r.list.length<=0?null:o.a.createElement("div",{className:O.heroContent},o.a.createElement(p.a,{maxWidth:"md"},o.a.createElement(l.a,{component:"h4",variant:"h4",align:"center",color:"textPrimary",gutterBottom:!0},"Welcome, ",n.nick),o.a.createElement(l.a,{variant:"h5",align:"center",color:"textSecondary",paragraph:!0},"Lets start cloning devices, this feature works with public devices or personal devices."),o.a.createElement("div",{className:O.heroButtons},o.a.createElement(ae.a,{container:!0,spacing:2,justify:"center"},o.a.createElement(ae.a,{item:!0,md:5,xs:12},o.a.createElement(ot,{value:r.source,devices:Object.values(r.list),label:"Choose a device source",onChange:i}),o.a.createElement("br",null),o.a.createElement(Nt,{className:O.vertialSpace,device:r.source,revision:r.selectedRevision.src,label:"Choose revision source",onChange:f}),o.a.createElement(Gt,{device:r.source,label:"Select platforms to be cloned",revision:r.selectedRevision.src,onChange:E}),r.selectedRevision.src&&o.a.createElement(oe.a,{justify:"center"},o.a.createElement(ie.a,{control:o.a.createElement(ce.a,{id:"user-meta",color:"primary",checked:r.cloneUserMeta,onChange:function(e){return s(e.target.checked)},inputProps:{"aria-label":"Clone all user-meta data (only if you are the owner)"}}),label:"Clone all user-meta data (only device owner)"}))),o.a.createElement(ae.a,{item:!0,md:2,xs:12},o.a.createElement(le.a,{className:"clone-icon",fontSize:"large"})),o.a.createElement(ae.a,{item:!0,md:5,xs:12},o.a.createElement(ot,{value:r.destination,devices:Object.values(r.list).filter((t=r.source,function(e){return!Ke(e,"device-meta",{})["pantavisor.arch"]||!Ke(t,"device-meta",{})["pantavisor.arch"]||Ke(t,"device-meta",{})["pantavisor.arch"]===Ke(e,"device-meta",{})["pantavisor.arch"]})),label:"Choose a device destination",onChange:u}),r.destination&&o.a.createElement("div",{className:"mt-sm--2 mt--7"},o.a.createElement(Gt,{device:r.destination,label:"Select platforms you want to keep",revision:r.selectedRevision.dest,onChange:m}))),o.a.createElement(ae.a,{item:!0,md:12},r.status!==Xe.CLONING.SUCCESS&&S&&o.a.createElement("div",{className:O.linearProgress},o.a.createElement(ue.a,null)," "),r.status!==Xe.CLONING.SUCCESS&&!S&&o.a.createElement("div",{className:O.flex},o.a.createElement(q.a,{variant:"contained",color:"default",onClick:d},"Clear form"),o.a.createElement(ft,{variant:"contained",color:"primary",buttonTxt:"Start update process",disabled:!r.source||!r.destination||!r.selectedRevision.src,dialogText:r.source&&r.destination&&r.selectedRevision.src?"Are you sure you want to clone ".concat(r.source["device-nick"]," (").concat(r.selectedRevision.src.rev,") to ").concat(r.destination["device-nick"],"?"):"",onConfirm:v})),r.status===Xe.CLONING.SUCCESS&&o.a.createElement(de.a,{severity:"success"},"Your device has been cloned!"))))))})),Wt=n(110),Ft=n(44),Ht=n(108),Kt=n(109),Bt={type:null,error:null};function Mt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Bt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"error/clean":return Bt;case"error/set":return Object(y.a)(Object(y.a)({},e),t.payload);default:return e}}var zt=function(){return Object(Ft.combineReducers)({devices:et,errors:Mt,auth:je})},Yt="true"===Object({NODE_ENV:"production",PUBLIC_URL:"/dolly",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_REDUX_DEBUG?Object(Ht.composeWithDevTools)({trace:!0,traceLimit:25}):Ft.compose;var Jt=Object(v.b)((function(e){return{token:e.auth.token,status:e.auth.status}}),{Login:$,GetUser:function(){return function(){var e=Object(O.a)(m.a.mark((function e(t,n){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t(J.inProgress()),(r=n()).auth.token){e.next=4;break}return e.abrupt("return",null);case 4:return e.abrupt("return",D(z.bind(null,r.auth.token),(function(e){return t(J.success(e))}),(function(e){return t(G(e,J.failure))})));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},SaveTokenAndRedirect:function(e){return function(t){t(X(e)),location.hash=""}}})((function(e){var t=e.children,n=e.status,r=e.token,a=e.Login,i=e.GetUser,u=e.SaveTokenAndRedirect;return Object(c.useEffect)((function(){var e=location.hash;""===e?e||r||a():u(e)}),[r,u,a]),Object(c.useEffect)((function(){null===n&&i()}),[i,n]),n===he.INPROGRESS?o.a.createElement(wt.a,null):o.a.createElement("div",{className:"App"},t)})),$t=(n(170),Object(Ft.createStore)(zt(),Yt(Ft.applyMiddleware.apply(void 0,Object(Wt.a)([Kt.a].filter((function(e){return!!e})))))));var Xt=function(){return o.a.createElement(v.a,{store:$t},o.a.createElement(Jt,null,o.a.createElement(ne,null,o.a.createElement(Vt,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(o.a.createElement(Xt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[130,1,2]]]);
//# sourceMappingURL=main.8fdd0ee6.chunk.js.map